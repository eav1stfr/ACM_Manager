CREATE TABLE departments (
    name_of_dep TEXT PRIMARY KEY,
    head_id BIGINT
);

CREATE TABLE meetings (
    id SERIAL PRIMARY KEY,
    venue TEXT NOT NULL,
    time TIMESTAMP NOT NULL,
    repeated BOOLEAN DEFAULT FALSE,
    department_id TEXT REFERENCES departments(name_of_dep) ON DELETE SET NULL
);

CREATE TABLE members (
    id BIGINT PRIMARY KEY,
    first_name TEXT NOT NULL,
    last_name TEXT NOT NULL,
    email TEXT UNIQUE NOT NULL,
    telegram TEXT UNIQUE NOT NULL,
    role TEXT NOT NULL,
    birthday DATE NOT NULL
);

CREATE TABLE tasks (
    id SERIAL PRIMARY KEY,
    description TEXT NOT NULL,
    deadline TIMESTAMP NOT NULL,
    complexity INT NOT NULL,
    status BOOLEAN DEFAULT FALSE,
    assigned BOOLEAN DEFAULT FALSE
);

CREATE TABLE department_members (
    member_id BIGINT REFERENCES members(id) ON DELETE CASCADE,
    department_name TEXT REFERENCES departments(name_of_dep) ON DELETE CASCADE,
    PRIMARY KEY (member_id, department_name)
);

CREATE TABLE member_tasks (
    member_id BIGINT REFERENCES members(id) ON DELETE CASCADE,
    task_id INT REFERENCES tasks(id) ON DELETE CASCADE,
    PRIMARY KEY (member_id, task_id)
);

